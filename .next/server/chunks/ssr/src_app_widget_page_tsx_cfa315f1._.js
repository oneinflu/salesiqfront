module.exports=[48102,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(93458),e=a.i(73327),f=a.i(31484),g=a.i(44934),h=a.i(58357),i=a.i(74940),j=a.i(53278),k=a.i(52507),l=a.i(15009),m=a.i(10782),n=a.i(83915),o=a.i(56711),p=a.i(50944);let q="https://salesiqbackendapis-qw2eh.ondigitalocean.app";function r(){let a=(0,p.useSearchParams)(),r=a.get("companyId"),v=a.get("websiteId"),w=a.get("parentUrl");if(!r)return(0,b.jsx)("div",{className:"flex h-screen items-center justify-center bg-gray-50 p-4 text-center",children:(0,b.jsxs)("div",{className:"max-w-xs text-sm text-red-600",children:[(0,b.jsx)("p",{className:"font-semibold mb-1",children:"Configuration Error"}),(0,b.jsx)("p",{children:"Missing company ID. Please check your embed code."})]})});let[x,y]=(0,c.useState)("home"),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)({name:"",email:"",phone:""}),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),P=(0,c.useRef)(!1),Q=(0,c.useRef)(null),R=(0,c.useRef)(null),[S,T]=(0,c.useState)([]),[U,V]=(0,c.useState)([]),[W,X]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=localStorage.getItem("salesiq_visitor_id");a&&!/^[0-9a-fA-F]{24}$/.test(a)&&(a=null,localStorage.removeItem("salesiq_visitor_id")),E(a),a&&(fetch(`${q}/api/chats/history/${a}`).then(a=>a.json()).then(a=>{Array.isArray(a)&&a.length>0&&A(a)}).catch(a=>console.error("Failed to fetch history:",a)),fetch(`${q}/api/visitors/${a}`).then(a=>{if(a.ok)return a.json();throw Error("Visitor not found")}).then(a=>{(a.email||a.phone)&&I(!0)}).catch(()=>{}));let b=sessionStorage.getItem("salesiq_session_id");b||(b=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),sessionStorage.setItem("salesiq_session_id",b)),R.current=(0,n.io)(q);let c=R.current,d=new Audio("https://codeskulptor-demos.commondatastorage.googleapis.com/pang/pop.mp3");c&&(c.on("connect",()=>{G(!0),c.emit("visitor:join",{companyId:r,existingVisitorId:a,sessionId:b,userAgent:navigator.userAgent,pageUrl:w||window.location.href,websiteId:v||void 0})}),c.on("visitor-registered",a=>{E(a._id),localStorage.setItem("salesiq_visitor_id",a._id),(a.email||a.phone)&&I(!0)}),c.on("new-message",a=>{A(b=>{if(a.tempId){let c=b.findIndex(b=>b._id===a.tempId);if(-1!==c){let d=[...b];return d[c]=a,d}}return b.some(b=>b._id===a._id)?b:[...b,a]}),"visitor"!==a.sender&&(d.play().catch(a=>console.log("Audio play failed:",a)),window.parent.postMessage({type:"salesiq:open"},"*")),"conversation"!==x&&y("conversation")}));let e=setInterval(()=>{R.current&&R.current.connected&&R.current.emit("visitor:heartbeat",{sessionId:b})},1e3);return()=>{clearInterval(e),c.disconnect()}},[r]),(0,c.useEffect)(()=>{"faqs"===x&&0===S.length&&(X(!0),fetch(`${q}/api/faqs`).then(a=>a.json()).then(a=>T(a)).catch(a=>console.error("Failed to fetch FAQs:",a)).finally(()=>X(!1))),"articles"===x&&0===U.length&&(X(!0),fetch(`${q}/api/articles`).then(a=>a.json()).then(a=>V(a)).catch(a=>console.error("Failed to fetch Articles:",a)).finally(()=>X(!1)))},[x]),(0,c.useEffect)(()=>{"conversation"===x&&Q.current?.scrollIntoView({behavior:"smooth"})},[z,x]);let Y=()=>{if(!B.trim()||!D||P.current)return;let a=R.current;if(a){P.current=!0,O(!0);let b=`temp-${Date.now()}`,c={_id:b,text:B,sender:"visitor",createdAt:new Date().toISOString()};A(a=>[...a,c]),a.emit("visitor-message",{visitorId:D,text:B,companyId:r,tempId:b}),C(""),setTimeout(()=>{P.current=!1,O(!1)},1e3)}};return(0,b.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50 font-sans",children:[(0,b.jsx)("header",{className:"bg-blue-600 p-6 text-white shrink-0 relative",children:(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("div",{className:"bg-white/20 p-2 rounded-lg inline-block mb-4",children:(0,b.jsx)(t,{className:"size-6 text-white"})}),(0,b.jsx)("h1",{className:"text-2xl font-bold mb-1",children:"SALES IQ"}),(0,b.jsx)("p",{className:"text-blue-100 text-sm",children:"We are here to help you!"})]})}),(0,b.jsxs)("main",{className:"flex-1 overflow-hidden relative",children:["home"===x&&(0,b.jsxs)("div",{className:"p-4 h-full overflow-y-auto",children:[(0,b.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between cursor-pointer hover:shadow-md transition-shadow",onClick:()=>y("conversation"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"bg-blue-100 p-2 rounded-full text-blue-600",children:(0,b.jsx)(e.MessageChatSquare,{className:"size-5"})}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:"Chat with us now"})]}),(0,b.jsx)("div",{className:"text-gray-400",children:(0,b.jsx)(u,{className:"size-5"})})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3",children:"Recent Conversations"}),z.length>0?(0,b.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>y("conversation"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"bg-green-100 p-2 rounded-full text-green-600",children:(0,b.jsx)(e.MessageChatSquare,{className:"size-4"})}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900 text-sm",children:"Support Team"}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:(0,o.format)(new Date(z[z.length-1].createdAt),"MMM d")})]})})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 line-clamp-2 pl-[44px]",children:["visitor"===z[z.length-1].sender?"You: ":"",z[z.length-1].text]})]}):(0,b.jsx)("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No recent conversations"})]})]}),"conversation"===x&&(0,b.jsx)("div",{className:"flex flex-col h-full",children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[0===z.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500 text-sm",children:"Start a conversation with us!"}):z.map(a=>(0,b.jsxs)("div",{className:(0,m.cx)("flex flex-col max-w-[85%]","visitor"===a.sender?"self-end items-end":"self-start items-start"),children:[(0,b.jsx)("div",{className:(0,m.cx)("px-4 py-2 rounded-2xl text-sm","visitor"===a.sender?"bg-blue-600 text-white rounded-br-none":"bg-white border border-gray-200 text-gray-800 rounded-bl-none shadow-sm"),children:a.text}),(0,b.jsx)("span",{className:"text-[10px] text-gray-400 mt-1 px-1",children:(0,o.format)(new Date(a.createdAt),"hh:mm a")})]},a._id)),(0,b.jsx)("div",{ref:Q})]}),(0,b.jsxs)("div",{className:"p-3 bg-white border-t border-gray-200",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Input,{placeholder:"Reply here...",value:B,onChange:a=>C(a),onKeyDown:a=>{"Enter"!==a.key||P.current||Y()},className:"pr-10",isDisabled:N||!F||!D}),(0,b.jsx)("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-blue-600 hover:text-blue-700 p-1 disabled:opacity-50",onClick:Y,disabled:N||!F||!D,children:(0,b.jsx)(h.Send01,{className:"size-5"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2 px-1",children:[(0,b.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:(0,b.jsx)(i.FaceSmile,{className:"size-5"})}),(0,b.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:(0,b.jsx)(j.Paperclip,{className:"size-5"})})]})]})]}):(0,b.jsxs)("div",{className:"flex-1 p-6 flex flex-col justify-center bg-white",children:[(0,b.jsxs)("div",{className:"text-center mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Introduce yourself"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Please fill out the form below to start chatting with our team."})]}),(0,b.jsxs)("form",{onSubmit:a=>{if(a.preventDefault(),!D||!J.name||!J.email)return;M(!0);let b=R.current;b&&(b.emit("lead:capture",{...J,visitorId:D,companyId:r}),I(!0),M(!1))},className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,b.jsx)(l.Input,{id:"name",placeholder:"John Doe",value:J.name,onChange:a=>K(b=>({...b,name:a})),isRequired:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,b.jsx)(l.Input,{id:"email",type:"email",placeholder:"john@example.com",value:J.email,onChange:a=>K(b=>({...b,email:a})),isRequired:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,b.jsx)(l.Input,{id:"phone",type:"tel",placeholder:"+1 (555) 000-0000",value:J.phone,onChange:a=>K(b=>({...b,phone:a})),isRequired:!0})]}),(0,b.jsx)(k.Button,{type:"submit",color:"primary",className:"w-full justify-center bg-blue-600 hover:bg-blue-700",disabled:L,children:L?"Starting Chat...":"Start Chat"})]})]})}),"faqs"===x&&(0,b.jsx)("div",{className:"p-4 h-full overflow-y-auto",children:W?(0,b.jsx)("div",{className:"flex items-center justify-center h-40 text-gray-400 text-sm",children:"Loading FAQs..."}):S.length>0?(0,b.jsx)("div",{className:"space-y-4",children:S.map(a=>(0,b.jsxs)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:[(0,b.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:a.question}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.answer})]},a._id))}):(0,b.jsx)("div",{className:"flex items-center justify-center h-40 text-gray-400 text-sm",children:"No FAQs available"})}),"articles"===x&&(0,b.jsx)("div",{className:"p-4 h-full overflow-y-auto",children:W?(0,b.jsx)("div",{className:"flex items-center justify-center h-40 text-gray-400 text-sm",children:"Loading Articles..."}):U.length>0?(0,b.jsx)("div",{className:"space-y-4",children:U.map(a=>(0,b.jsxs)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:[(0,b.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:a.title}),(0,b.jsx)("p",{className:"text-sm text-gray-500 line-clamp-3 mb-2",children:a.content}),(0,b.jsx)("button",{className:"text-blue-600 text-xs font-medium hover:underline",children:"Read more"})]},a._id))}):(0,b.jsx)("div",{className:"flex items-center justify-center h-40 text-gray-400 text-sm",children:"No articles available"})})]}),(0,b.jsxs)("nav",{className:"bg-white border-t border-gray-200 shrink-0",children:[(0,b.jsxs)("div",{className:"grid grid-cols-4 h-16",children:[(0,b.jsx)(s,{active:"home"===x,onClick:()=>y("home"),icon:d.HomeLine,label:"Home"}),(0,b.jsx)(s,{active:"conversation"===x,onClick:()=>y("conversation"),icon:e.MessageChatSquare,label:"Conversation"}),(0,b.jsx)(s,{active:"faqs"===x,onClick:()=>y("faqs"),icon:f.HelpCircle,label:"FAQs"}),(0,b.jsx)(s,{active:"articles"===x,onClick:()=>y("articles"),icon:g.File02,label:"Articles"})]}),(0,b.jsx)("div",{className:"bg-gray-50 py-1 text-center border-t border-gray-100",children:(0,b.jsxs)("span",{className:"text-[10px] text-gray-400 flex items-center justify-center gap-1",children:[(0,b.jsx)("span",{className:"text-red-400",children:"âš¡"})," Driven by  SalesIQ"]})})]})]})}function s({active:a,onClick:c,icon:d,label:e}){return(0,b.jsxs)("button",{onClick:c,className:(0,m.cx)("flex flex-col items-center justify-center gap-1 transition-colors",a?"text-blue-600":"text-gray-500 hover:text-gray-700"),children:[(0,b.jsx)(d,{className:(0,m.cx)("size-5",a?"stroke-[2.5px]":"stroke-2")}),(0,b.jsx)("span",{className:"text-[10px] font-medium",children:e})]})}function t({className:a}){return(0,b.jsx)("svg",{className:a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{d:"M8 22H16M12 2V22M3 22H21M5 22V10M19 22V10M5 10L12 2L19 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function u({className:a}){return(0,b.jsx)("svg",{className:a,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,b.jsx)("path",{d:"M9 18L15 12L9 6",strokeLinecap:"round",strokeLinejoin:"round"})})}function v(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{children:"Loading..."}),children:(0,b.jsx)(r,{})})}a.s(["default",()=>v])}];

//# sourceMappingURL=src_app_widget_page_tsx_cfa315f1._.js.map